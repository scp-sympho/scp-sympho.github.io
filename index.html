<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>„Éã„É•„Éº„ÇπÔºÜ‰ºöÁ§æÊÉÖÂ†±„Åæ„Å®„ÇÅ</title>
<style>
body {
    font-family: 'Segoe UI', sans-serif;
    background-color: #f7faff;
    margin: 0;
    padding: 20px;
    color: #333;
}

h1 {
    text-align: center;
    color: #0078d7;
    position: relative;
}

.viewer-counter {
    position: absolute;
    top: 0;
    right: 10px;
    font-size: 12px;
    color: #888;
}

.viewer-info {
    position: absolute;
    top: 5px;
    right: 10px;
    font-size: 12px;
    color: #888;
    text-align: right;
}

.subtitle {
    margin-top: -0.3em;
    font-size: 0.95em;
    color: #555;
    text-align: center;
    letter-spacing: 0.03em;
}

.tabs {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 15px;
}

.tab {
    background: #e0ecff;
    border: none;
    border-radius: 8px;
    padding: 10px 15px;
    cursor: pointer;
    font-weight: bold;
    transition: 0.2s;
}

.tab.active {
    background: #0078d7;
    color: white;
}

.controls {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

input, select, button {
    padding: 8px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 14px;
}

.news-list, .research-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 15px;
}

.info-list{
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(450px, 1fr));
    gap: 15px;
}


.card {
    display: flex;
    flex-direction: column;
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    padding: 15px;
    transition: transform 0.2s;
    position: relative;
    overflow: visible;
}

.card:hover {
    transform: scale(1.02);
}

.card a {
    color: #0078d7;
    text-decoration: none;
    font-weight: bold;
}

.card a:hover {
    text-decoration: underline;
}

.date {
    color: #888;
    font-size: 13px;
    margin-bottom: 8px;
}

.source {
    margin-top: auto;
    font-size: 12px;
    color: #888;
    text-align: right;
}

.new-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background-color: red;
    color: white;
    font-size: 11px;
    font-weight: bold;
    padding: 3px 6px;
    border-radius: 8px;
    animation: floatBadge 1.5s ease-in-out infinite;
}

@keyframes floatBadge {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-2px); }
}

.pagination {
    text-align: center;
    margin-top: 20px;
}

button.action {
    background-color: #0078d7;
    color: white;
    border: none;
    cursor: pointer;
}

button.action:hover {
    background-color: #005fa3;
}

button:disabled {
    background-color: #ccc;
    cursor: not-allowed;
}
</style>
</head>
<body>

<h1>
    „Éã„É•„Éº„Çπ„Çµ„Ç§„ÉàRSS„Éì„É•„Éº„Ç¢
    <!-- <span class="viewer-counter">Ver.0.2</span> -->
    <div class="viewer-info">
        <div>Ver.0.2</div>
        <div>Last Update : 2026-02-12</div>
    </div>

</h1>
<p class="subtitle">‰ø°È†º„Åß„Åç„ÇãÊÉÖÂ†±„Çí„ÄÅ„Çà„ÇäÊó©„Åè„ÄÅ„Çà„ÇäÊ≠£Á¢∫„Å´„ÄÇ</p>

<div class="tabs">
    <button id="tab-news" class="tab active">„Éã„É•„Éº„Çπ</button>
    <button id="tab-research" class="tab">‰ºöÁ§æÊÉÖÂ†±</button>
    <button id="tab-expert" class="tab">Â∞ÇÈñÄÊÉÖÂ†±</button>
    <button id="tab-info" class="tab">ÊÉÖÂ†±„Çµ„Ç§„Éà</button>
    <button id="refresh" class="action">üîÑ Êõ¥Êñ∞</button>
</div>

<div id="news-section">
    <div class="controls">
        <input type="text" id="search" placeholder="„Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢...">

        <select id="sort">
            <option value="newest">Êñ∞„Åó„ÅÑÈ†Ü</option>
            <option value="oldest">Âè§„ÅÑÈ†Ü</option>
        </select>

        <select id="sourceFilter">
            <option value="all">ÂÖ®„Å¶„ÅÆÂá∫ÂÖ∏</option>
        </select>

        <!-- ‚òÖËøΩÂä†ÔºöÊó•‰ªòÁØÑÂõ≤ -->
        <input type="date" id="dateFrom">
        <span>ÔΩû</span>
        <input type="date" id="dateTo">

        <select id="itemsPerPage">
            <option value="20">20‰ª∂Ë°®Á§∫</option>
            <option value="50" selected>50‰ª∂Ë°®Á§∫</option>
            <option value="100">100‰ª∂Ë°®Á§∫</option>
        </select>
    </div>

    <div id="news" class="news-list"></div>
    <div class="pagination">
        <button id="prev">Ââç„Å∏</button>
        <span id="pageInfo"></span>
        <button id="next">Ê¨°„Å∏</button>
    </div>
</div>

<div id="research-section" style="display:none;">
    <div class="controls">
        <select id="companyFilter"><option value="all">ÂÖ®„Å¶„ÅÆ‰ºöÁ§æ</option></select>
    </div>
    <div id="research" class="research-list"></div>
</div>

<div id="expert-section" style="display:none;">
    <div class="controls">
        <select id="ExpertFilter"><option value="all">ÂÖ®„Å¶„ÅÆÂá∫ÂÖ∏</option></select>
    </div>
    <div id="expert" class="news-list"></div>
</div>

<div id="info-section" style="display:none;">
    <div class="controls">
        <select id="infoFilter"><option value="all">ÂÖ®„Å¶„ÅÆÂá∫ÂÖ∏</option></select>
    </div>
    <div id="info" class="info-list"></div>
</div>



<script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    let ITEMS_PER_PAGE = parseInt(document.getElementById('itemsPerPage').value);
    let allNews = [], filteredNews = [], currentPage = 1;
    let allResearch = [], filteredResearch = [];
    let allExpert = [], filteredExpert = [];
    let allinfo = [], filteredinfo = [];


    async function loadCSV(file) {
        const res = await fetch(file);
        const text = await res.text();

        const result = Papa.parse(text, {
            header: true,
            skipEmptyLines: true
        });

        return result.data;
    }

    function parseDate(dateStr) {
        if(!dateStr) return '';
        const d = new Date(dateStr);
        return isNaN(d) ? '' : dateStr;
    }

    function isToday(dateStr) {
        const d = new Date(dateStr);
        const now = new Date();
        return d.getFullYear() === now.getFullYear() &&
               d.getMonth() === now.getMonth() &&
               d.getDate() === now.getDate();
    }

    function renderNews() {
        const container = document.getElementById('news');
        container.innerHTML = '';
        const start = (currentPage - 1) * ITEMS_PER_PAGE;
        const pageItems = filteredNews.slice(start, start + ITEMS_PER_PAGE);
        pageItems.forEach(item => {
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `
                ${isToday(item.date) ? '<div class="new-badge">New!</div>' : ''}
                <div class="date">${parseDate(item.date)}</div>
                <a href="${item.link}" target="_blank">${item.title || '(ÁÑ°È°å)'}</a>
                <p>${item.description || ''}</p>
                <div class="source">Âá∫ÂÖ∏Ôºö${item.source || '‰∏çÊòé'}</div>
            `;
            container.appendChild(div);
        });
        document.getElementById('pageInfo').textContent = `${currentPage} / ${Math.ceil(filteredNews.length / ITEMS_PER_PAGE)}`;
        document.getElementById('prev').disabled = currentPage === 1;
        document.getElementById('next').disabled = start + ITEMS_PER_PAGE >= filteredNews.length;
    }

    function applyNewsFilters() {
        const query = document.getElementById('search').value.toLowerCase();
        const selectedSource = document.getElementById('sourceFilter').value;

        const fromInput = document.getElementById('dateFrom').value;
        const toInput = document.getElementById('dateTo').value;

        const fromDate = fromInput ? new Date(fromInput + 'T00:00:00') : null;
        const toDate = toInput ? new Date(toInput + 'T23:59:59') : null;

        filteredNews = allNews.filter(r => {
            // „Ç≠„Éº„ÉØ„Éº„Éâ
            const matchKeyword =
                r.title.toLowerCase().includes(query) ||
                r.description.toLowerCase().includes(query);

            // Âá∫ÂÖ∏
            const matchSource =
                selectedSource === 'all' || r.source === selectedSource;

            // Êó•‰ªò
            let matchDate = true;
            const itemDate = new Date(r.date);

            if (!isNaN(itemDate)) {
                if (fromDate && toDate) {
                    matchDate = itemDate >= fromDate && itemDate <= toDate;
                } else if (fromDate) {
                    matchDate = itemDate >= fromDate;
                } else if (toDate) {
                    matchDate = itemDate <= toDate;
                }
            }

            return matchKeyword && matchSource && matchDate;
        });

        const sort = document.getElementById('sort').value;
        filteredNews.sort((a, b) => {
            const da = new Date(a.date);
            const db = new Date(b.date);
            return sort === 'newest' ? db - da : da - db;
        });

        currentPage = 1;
        renderNews();
    }



    function renderResearch() {
        const container = document.getElementById('research');
        container.innerHTML = '';
        filteredResearch.sort((a,b) => new Date(b.date) - new Date(a.date));
        filteredResearch.forEach(item => {
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `
                ${isToday(item.date) ? '<div class="new-badge">New!</div>' : ''}
                <div class="date">${parseDate(item.date)}</div>
                <a href="${item.link}" target="_blank">${item.company}</a>
                <p>${item.info}</p>
            `;
            container.appendChild(div);
        });
    }


    function applyResearchFilters() {
        const company = document.getElementById('companyFilter').value;
        filteredResearch = allResearch.filter(r => company === 'all' || r.company === company);
        renderResearch();
    }

    function renderExpert() {
        const container = document.getElementById('expert');
        container.innerHTML = '';
        const start = (currentPage - 1) * ITEMS_PER_PAGE;
        const pageItems = filteredExpert.slice(start, start + ITEMS_PER_PAGE);
        pageItems.forEach(item => {
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `
                ${isToday(item.date) ? '<div class="new-badge">New!</div>' : ''}
                <div class="date">${parseDate(item.date)}</div>
                <a href="${item.link}" target="_blank">${item.title || '(ÁÑ°È°å)'}</a>
                <p>${item.description || ''}</p>
                <div class="source">Âá∫ÂÖ∏Ôºö${item.source || '‰∏çÊòé'}</div>
            `;
            container.appendChild(div);
        });
        document.getElementById('pageInfo').textContent = `${currentPage} / ${Math.ceil(filteredExpert.length / ITEMS_PER_PAGE)}`;
        document.getElementById('prev').disabled = currentPage === 1;
        document.getElementById('next').disabled = start + ITEMS_PER_PAGE >= filteredExpert.length;
    }

    function applyExpertFilters() {
        const selectedSource = document.getElementById('ExpertFilter').value;
        filteredExpert = allExpert.filter(r => selectedSource === 'all' || r.source === selectedSource);
        renderExpert();
    }

    function renderinfo() {
        const container = document.getElementById('info');
        container.innerHTML = '';
        const start = (currentPage - 1) * ITEMS_PER_PAGE;
        const pageItems = filteredinfo.slice(start, start + ITEMS_PER_PAGE);
        pageItems.forEach(item => {
            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `
                ${isToday(item.date) ? '<div class="new-badge">New!</div>' : ''}
                <div class="date">${parseDate(item.date)}</div>
                <a href="${item.link}" target="_blank">${item.title || '(ÁÑ°È°å)'}</a>
                <p>${item.description || ''}</p>
                <div class="source">Âá∫ÂÖ∏Ôºö${item.source || '‰∏çÊòé'}</div>
            `;
            container.appendChild(div);
        });
        document.getElementById('pageInfo').textContent = `${currentPage} / ${Math.ceil(filteredinfo.length / ITEMS_PER_PAGE)}`;
        document.getElementById('prev').disabled = currentPage === 1;
        document.getElementById('next').disabled = start + ITEMS_PER_PAGE >= filteredinfo.length;
    }

    function applyinfoFilters() {
        const selectedSource = document.getElementById('infoFilter').value;
        filteredinfo = allinfo.filter(r => selectedSource === 'all' || r.source === selectedSource);
        renderinfo();
    }


    async function refreshData() {
        allNews = await loadCSV('rss.csv');
        filteredNews = [...allNews];
        applyNewsFilters();
        const sources = [...new Set(allNews.map(r => r.source).filter(s => s))].sort();
        const sourceSel = document.getElementById('sourceFilter');
        sourceSel.innerHTML = '<option value="all">ÂÖ®„Å¶„ÅÆÂá∫ÂÖ∏</option>' + 
            sources.map(s => `<option value="${s}">${s}</option>`).join('');

        allResearch = await loadCSV('research.csv');
        filteredResearch = [...allResearch];
        const companies = [...new Set(allResearch.map(r => r.company))].sort();
        const sel = document.getElementById('companyFilter');
        sel.innerHTML = '<option value="all">ÂÖ®„Å¶„ÅÆ‰ºöÁ§æ</option>' + companies.map(c => `<option value="${c}">${c}</option>`).join('');
        applyResearchFilters();

        allExpert = await loadCSV('expert.csv');
        filteredExpert = [...allExpert]
        applyExpertFilters();
        const expertSources = [...new Set(allExpert.map(r => r.source).filter(s => s))].sort();
        const expertSel = document.getElementById('ExpertFilter');
        expertSel.innerHTML = '<option value="all">ÂÖ®„Å¶„ÅÆÂá∫ÂÖ∏</option>' + expertSources.map(s => `<option value="${s}">${s}</option>`).join('');

        allinfo = await loadCSV('info.csv');
        filteredinfo = [...allinfo]
        applyinfoFilters();
        const infoSources = [...new Set(allinfo.map(r => r.source).filter(s => s))].sort();
        const infoSel = document.getElementById('infoFilter');
        infoSel.innerHTML = '<option value="all">ÂÖ®„Å¶„ÅÆÂá∫ÂÖ∏</option>' + infoSources.map(s => `<option value="${s}">${s}</option>`).join('');
    }

    document.getElementById('itemsPerPage').addEventListener('change', () => {
        ITEMS_PER_PAGE = parseInt(document.getElementById('itemsPerPage').value);
        currentPage = 1;

        if (document.getElementById('news-section').style.display !== 'none') {
            renderNews();
        }
        else if (document.getElementById('research-section').style.display !== 'none') {
            renderResearch();
        }
        else if (document.getElementById('expert-section').style.display !== 'none') {
            renderExpert();
        }else if (document.getElementById('info-section').style.display !== 'none') {
            renderinfo();
        }
    });


    document.getElementById('search').addEventListener('input', applyNewsFilters);
    document.getElementById('sort').addEventListener('change', applyNewsFilters);
    document.getElementById('prev').addEventListener('click', ()=>{if(currentPage>1){currentPage--;renderNews();}});
    document.getElementById('next').addEventListener('click', ()=>{if(currentPage*ITEMS_PER_PAGE<filteredNews.length){currentPage++;renderNews();}});
    document.getElementById('sourceFilter').addEventListener('change', applyNewsFilters);
    document.getElementById('companyFilter').addEventListener('change', applyResearchFilters);
    document.getElementById('ExpertFilter').addEventListener('change', applyExpertFilters);
    document.getElementById('infoFilter').addEventListener('change', applyinfoFilters);

    document.getElementById('tab-news').addEventListener('click', ()=>{
        document.getElementById('tab-news').classList.add('active');
        document.getElementById('tab-research').classList.remove('active');
        document.getElementById('tab-expert').classList.remove('active');
        document.getElementById('tab-info').classList.remove('active');
        document.getElementById('news-section').style.display='block';
        document.getElementById('research-section').style.display='none';
        document.getElementById('expert-section').style.display='none';
        document.getElementById('info-section').style.display='none';
    });

    document.getElementById('tab-research').addEventListener('click', ()=>{
        document.getElementById('tab-research').classList.add('active');
        document.getElementById('tab-news').classList.remove('active');
        document.getElementById('tab-expert').classList.remove('active');
        document.getElementById('tab-info').classList.remove('active');
        document.getElementById('news-section').style.display='none';
        document.getElementById('research-section').style.display='block';
        document.getElementById('expert-section').style.display='none';
        document.getElementById('info-section').style.display='none';
    });

    document.getElementById('tab-expert').addEventListener('click', ()=>{
        document.getElementById('tab-expert').classList.add('active');
        document.getElementById('tab-news').classList.remove('active');
        document.getElementById('tab-research').classList.remove('active');
        document.getElementById('tab-info').classList.remove('active');
        document.getElementById('news-section').style.display='none';
        document.getElementById('research-section').style.display='none';
        document.getElementById('expert-section').style.display='block';
        document.getElementById('info-section').style.display='none';
    });

    document.getElementById('tab-info').addEventListener('click', ()=>{
        document.getElementById('tab-info').classList.add('active');
        document.getElementById('tab-news').classList.remove('active');
        document.getElementById('tab-research').classList.remove('active');
        document.getElementById('tab-expert').classList.remove('active');
        document.getElementById('news-section').style.display='none';
        document.getElementById('research-section').style.display='none';
        document.getElementById('expert-section').style.display='none';
        document.getElementById('info-section').style.display='block';
    });


    document.getElementById('refresh').addEventListener('click', refreshData);
    document.getElementById('dateFrom').addEventListener('change', applyNewsFilters);
    document.getElementById('dateTo').addEventListener('change', applyNewsFilters);


    refreshData();
});
</script>

</body>
</html>
